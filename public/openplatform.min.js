var OPENPLATFORM={};OPENPLATFORM.version='2.0.0',OPENPLATFORM.callbacks={},OPENPLATFORM.events={},OPENPLATFORM.is=top!==window,OPENPLATFORM.init=function(e){if(e||(e=function(e){!0!==e&&(document.body.innerHTML='401: Unauthorized',setTimeout(function(){window.close()},2e3))}),OPENPLATFORM.is){for(var n=location.search.substring(1).split('&'),t=null,r=0,o=n.length;r<o;r++){var i=n[r];if('openplatform='===i.substring(0,13)){t=decodeURIComponent(i.substring(13));break}}var O={};O.ua=navigator.userAgent,OPENPLATFORM.accesstoken=t;var a=setTimeout(function(){a=null,e('timeout')},1500);OPENPLATFORM.send('verify',O,function(n,t){a&&(clearTimeout(a),e(null,t,setTimeout(function(){t.href&&(location.href=t.href)},100))),a=null})}else e(new Error('OpenPlatform isn\'t detected.'))},OPENPLATFORM.loading=function(e){return OPENPLATFORM.send('loading',e)},OPENPLATFORM.message=function(e,n){var t={};return t.body=e,t.type=n,OPENPLATFORM.send('message',t)},OPENPLATFORM.meta=function(e){var n={};n.ua=navigator.userAgent,n.accesstoken=OPENPLATFORM.accesstoken,OPENPLATFORM.send('meta',n,function(n,t){e(n,t)})},OPENPLATFORM.play=function(e){return OPENPLATFORM.send('play',e)},OPENPLATFORM.stop=function(e){return OPENPLATFORM.send('stop',e)},OPENPLATFORM.maximize=function(e){return OPENPLATFORM.send('maximize',e)},OPENPLATFORM.restart=function(){return OPENPLATFORM.send('restart',location.href)},OPENPLATFORM.open=function(e,n){return OPENPLATFORM.send('open',{id:e,data:n})},OPENPLATFORM.minimize=function(){return OPENPLATFORM.send('minimize')},OPENPLATFORM.close=function(){return OPENPLATFORM.send('kill')},OPENPLATFORM.notify=function(e,n,t){return'string'==typeof e&&(t=n,n=e,e=0),OPENPLATFORM.send('notify',{type:e,body:n,url:t||'',datecreated:new Date})},OPENPLATFORM.email=function(e,n){return OPENPLATFORM.send('email',{subject:e,body:n,datecreated:new Date})},OPENPLATFORM.send=function(e,n,t){'function'==typeof n&&(t=n,n=null);var r={};if(r.openplatform=!0,r.accesstoken=OPENPLATFORM.accesstoken,r.type=e,r.body=n||null,r.sender=!0,r.origin=location.origin,top)return t&&(r.callback=(1e6*Math.random()).toString(32).replace(/\./g,''),OPENPLATFORM.callbacks[r.callback]=t),top.postMessage(JSON.stringify(r),'*'),OPENPLATFORM;t&&t(new Error('The application is not running in the OpenPlatform scope.'))},OPENPLATFORM.on=function(e,n){return!OPENPLATFORM.events[e]&&(OPENPLATFORM.events[e]=[]),OPENPLATFORM.events[e].push(n),OPENPLATFORM},window.addEventListener('message',function(e){try{var n=JSON.parse(e.data);if(!n.openplatform)return;if(n.callback){var t=OPENPLATFORM.callbacks[n.callback];return void(t&&(n.sender&&(n.error=new Error('The application is not running in the OpenPlatform scope.')),t(n.error,n.body||{}),delete OPENPLATFORM.callbacks[n.callback]))}if(n.sender)return;if('reload'===n.type)return void location.reload(!0);if('redirect'===n.type)return void(location.href=n.body);'kill'===n.type&&(n.type='close');var r=OPENPLATFORM.events[n.type];r&&r.forEach(function(e){e(n.body||{})})}catch(e){}},!1);